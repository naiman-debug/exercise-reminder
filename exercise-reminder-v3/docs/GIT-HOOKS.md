# Git Hooks é…ç½®æ–‡æ¡£

> **é¡¹ç›®**ï¼šexercise-reminder-v3
> **ç‰ˆæœ¬**ï¼šv2.0
> **æ›´æ–°æ—¥æœŸ**ï¼š2026-02-01
> **å·¥å…·**ï¼šHusky v9.1.7

---

## æ¦‚è¿°

é¡¹ç›®ä½¿ç”¨ Husky ç®¡ç† Git hooksï¼Œç¡®ä¿ä»£ç è´¨é‡å’Œå›¢é˜Ÿåä½œè§„èŒƒã€‚

### Hooks æ¸…å•

| Hook | è§¦å‘æ—¶æœº | åŠŸèƒ½ | çŠ¶æ€ |
|------|----------|------|------|
| `pre-commit` | æäº¤å‰ | ç±»å‹æ£€æŸ¥ + å•å…ƒæµ‹è¯• | å·²é…ç½® |
| `commit-msg` | ä¿¡æ¯ç¼–è¾‘å | Conventional Commits æ£€æŸ¥ | å·²é…ç½® |
| `post-commit` | æäº¤å®Œæˆå | è‡ªåŠ¨æ›´æ–° WORK-LOG.md | å·²é…ç½® |
| `pre-push` | æ¨é€å‰ | ä¿æŠ¤åˆ†æ”¯ + æœ€ç»ˆæµ‹è¯• | å·²é…ç½® |

---

## Pre-commit Hook

### åŠŸèƒ½
- TypeScript ç±»å‹æ£€æŸ¥ï¼ˆ`npm run typecheck`ï¼‰
- å•å…ƒæµ‹è¯•ï¼ˆ`npm run test`ï¼‰

### æ‰§è¡Œæµç¨‹
```
1/2 ç±»å‹æ£€æŸ¥...
2/2 å•å…ƒæµ‹è¯•...
=== æ‰€æœ‰æ£€æŸ¥é€šè¿‡ ===
```

### å¤±è´¥å¤„ç†
```
ç±»å‹æ£€æŸ¥å¤±è´¥ï¼è¯·ä¿®å¤ TypeScript é”™è¯¯åå†æäº¤ã€‚
æµ‹è¯•å¤±è´¥ï¼è¯·ç¡®ä¿æ‰€æœ‰æµ‹è¯•é€šè¿‡åå†æäº¤ã€‚
```

### è·³è¿‡æ–¹å¼
```bash
git commit --no-verify -m "message"
```

---

## Commit-msg Hook

### è§„èŒƒæ ‡å‡†ï¼šConventional Commits

```
<type>(<scope>): <subject>
```

### å…è®¸çš„ Type

| Type | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| `feat` | æ–°åŠŸèƒ½ | `feat: æ·»åŠ ç”¨æˆ·ç™»å½•` |
| `fix` | Bug ä¿®å¤ | `fix: ä¿®å¤æŸ¥è¯¢è¶…æ—¶` |
| `docs` | æ–‡æ¡£æ›´æ–° | `docs(readme): æ›´æ–°è¯´æ˜` |
| `style` | ä»£ç æ ¼å¼ | `style: ç»Ÿä¸€ç¼©è¿›` |
| `refactor` | é‡æ„ | `refactor(api): ç®€åŒ–æ¥å£` |
| `test` | æµ‹è¯•ç›¸å…³ | `test: æ·»åŠ å•å…ƒæµ‹è¯•` |
| `chore` | æ„å»º/å·¥å…· | `chore: æ›´æ–°ä¾èµ–` |
| `perf` | æ€§èƒ½ä¼˜åŒ– | `perf: ä¼˜åŒ–æŸ¥è¯¢æ€§èƒ½` |
| `ci` | CI é…ç½® | `ci: æ·»åŠ  workflow` |

### ç¤ºä¾‹
```
feat(database): æ·»åŠ ç”¨æˆ·æ•°æ®è¿ç§»åŠŸèƒ½

- åˆ›å»ºè¿ç§»è„šæœ¬
- æ·»åŠ å›æ»šæ”¯æŒ
- æ›´æ–°æ–‡æ¡£

Closes #123
```

### è·³è¿‡æ–¹å¼
```bash
git commit --no-verify -m "message"
```

---

## Post-commit Hook

### åŠŸèƒ½
è‡ªåŠ¨è®°å½•æ¯æ¬¡æäº¤åˆ° `docs/WORK-LOG.md`ï¼š
- Commit æ—¶é—´
- Commit ä¿¡æ¯
- æäº¤è€…åç§°
- Commit Hash
- å˜æ›´æ–‡ä»¶åˆ—è¡¨

### è¾“å‡ºæ ¼å¼
```markdown
## ğŸ“ Git Commit è®°å½•

**æ—¶é—´**ï¼š2026-02-01 15:30
**æäº¤è€…**ï¼šClaude Code
**Commit**ï¼š`abc123...`

### æäº¤ä¿¡æ¯
> feat: æ·»åŠ æ–°åŠŸèƒ½

### å˜æ›´æ–‡ä»¶
```
M src/App.tsx
A src/NewFeature.tsx
```

**è‡ªåŠ¨è®°å½•äº**ï¼š2026-02-01 15:30:05
```

---

## Pre-push Hook

### åŠŸèƒ½
- æ£€æŸ¥æ˜¯å¦ç›´æ¥æ¨é€åˆ° `main/master` åˆ†æ”¯
- è¿è¡Œæœ€ç»ˆæµ‹è¯•éªŒè¯

### ä¿æŠ¤åˆ†æ”¯æ£€æŸ¥
```bash
=== è­¦å‘Šï¼šç›´æ¥æ¨é€åˆ°ä¿æŠ¤åˆ†æ”¯ main ===

å»ºè®®ï¼š
1. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯è¿›è¡Œå¼€å‘
2. ä½¿ç”¨ Pull Request åˆå¹¶ä»£ç 

ç¡®è®¤è¦ç»§ç»­æ¨é€å—ï¼Ÿ(yes/no):
```

### è·³è¿‡æ–¹å¼
```bash
git push --no-verify
```

---

## æ•…éšœæ’é™¤

### Hooks ä¸æ‰§è¡Œ

1. æ£€æŸ¥ Husky æ˜¯å¦å®‰è£…ï¼š
   ```bash
   npm list husky
   ```

2. é‡æ–°å®‰è£… hooksï¼š
   ```bash
   npm run prepare
   ```

3. æ£€æŸ¥æ–‡ä»¶æƒé™ï¼š
   ```bash
   chmod +x .husky/*
   ```

### æäº¤ä¿¡æ¯æ ¼å¼é”™è¯¯

ä½¿ç”¨åœ¨çº¿å·¥å…·éªŒè¯ï¼šhttps://commitlint.js.org/#/

### Post-commit ä¸æ›´æ–°æ—¥å¿—

æ£€æŸ¥ `docs/WORK-LOG.md` æ–‡ä»¶æ˜¯å¦å­˜åœ¨ã€‚

---

## ç›¸å…³æ–‡æ¡£

| æ–‡æ¡£ | è·¯å¾„ | è¯´æ˜ |
|------|------|------|
| **çº¦æŸè§„åˆ™** | `constraints/README.md` | é¡¹ç›®å¼€å‘çº¦æŸ |
| **æµ‹è¯•è§„åˆ™** | `constraints/testing-rules.md` | æµ‹è¯•è§„èŒƒ |
| **å·¥ä½œæ—¥å¿—** | `docs/WORK-LOG.md` | å·²å®Œæˆå·¥ä½œå½’æ¡£ |
| **ä»»åŠ¡çœ‹æ¿** | `docs/TASKS.md` | æœªå®Œæˆä»»åŠ¡è·Ÿè¸ª |
